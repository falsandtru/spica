os: linux
dist: xenial
language: node_js
jobs:
  include:
  - os: linux
    node_js: 12
  - os: osx
    node_js: 12
addons:
  chrome: stable
  firefox: latest
services:
- xvfb
script:
- npm run ci
before_deploy:
- sed -i 's/"private":\ true/"private":\ false/' package.json
- sed -i -E 's/^dist\/?.*$//' .gitignore
- cp -r src/* .
deploy:
  provider: npm
  edge: true
  email:
    secure: c/u3dsMFxB/JwNNUa3G+aotltA08al8k4SfpJGe3g3/yiNeDz1YSJw9N+2DK8USWrfDK8YB1cZIFscGbrjD6OU37IKzovZooAcmtDyopRB7dGMeajoFtCT2TtBX38mwp3LNqR84iKRPwLlpV+Lv5qpyzQpaqyzcD5TeKObCd85RdSR3AqkDVi7BgkewRpU3M/J1EXZ6a5VbPky4cskRNbQDK/LPFr8AQflO21bwLkciDgRrPvx5Bbp+w/KXukQIOeMVGnygY/j9M/kesXIPDqXQKGnLxKo0H5hZs4u+74F+JshlS4x3FPBX/NemPpAKTD3fZ3MvQqpMLsYdLF4VUO4FizJkPLOaJB/ZJ+JCPJexbI/duj3BpvhPpp/8MP3n0jCH6w9hLqhRBvLkwDYwY/xp6KVLhvWfdqhMFHwJC1nyLmtBc4OHSNhgdqddYaVOUj1q9xzvWyp/LhsqKNguKSn1EnAar4N/+uJ3kwdOHapQLV1Wxk7KBGfD3vawTzlUlpBRP/yrqgVl7mdCEMuj1xpx4EDy/5HXYlGyvmk1/avKia4KpwCowJzIQzHUSigfOOfnaP0+J74b1OhENeeQ9Gg2VwZ7tw5j2MN5FKnE42d9CilrheRYZNm2D25mFoHosHpgEu1/YyK2//ll6bsTfr2pk6YR+3WfwjCR4kgNGEV0=
  api_token:
    secure: "EOf6w/ttjOfB4hZ/moCpcW8CCzPe2KSO066lLsSmZ5Pz5aQlcCxfaFOiNx7Mpho9/LmuHvuBMHwtyycHf5/JyfxUEBGEGdHK/vtR4Fu98aOmBwQaa73Kh7gXcbPzpnk6ySZziIk3vkTfbZxXacycn93jSlWo+hkvyiuHKKIKZi4AmvDIYZx0ozJMb218wrR2KIAwrT7wUcKNWBmVAdOABnPNWOlHhhmbVGvDx07RalYpEU0ADRhGB9BN17QqGpyjCSFbUHDIEbHbgeoBx4/LFprIFxADbtWKZYWA2lXMxegtg9D7rDavzQVPjwdePCuFiyy8zVqwuJiBQTuGRJhiGH90349jDnoq0oNBPokYm71IT7dANdf4b3vtiPGE47AdR25HjEJTB6XRWREiz0yDnM548zODpahIXXFgiyp2y1aDMzeRJiol/VqQnVtLAz5DP6pBaBxA1SMw/I9UVqERfxMivN0bedB/+35xNoDFqiZgFpdkcTkAEkGiHyj5L9nVWnKS/+2Jq7M44eBcCeeq5dZ62AJDaJhDQUQPzhyioRwpkn8ua+NpdKY+gGGYo4sfhTMNLQAGtnEPKWNCTQufbywutDdQyH9GWdxmSjFvTDdO3qAxbd+qNVQ7Shz5H1aAbq2l0FoCFVXNECA+E0kjYN0NLOLCRKSZRHXf8ubn6mA="
  on:
    node_js: 12
    condition:
    - $TRAVIS_BRANCH = master
    - $TRAVIS_EVENT_TYPE = push
    - $TRAVIS_COMMIT_MESSAGE =~ ^v[0-9]+(\.[0-9]+)*($|\n)
    - $TRAVIS_OS_NAME = linux
notifications:
  email:
    recipients:
      secure: c/u3dsMFxB/JwNNUa3G+aotltA08al8k4SfpJGe3g3/yiNeDz1YSJw9N+2DK8USWrfDK8YB1cZIFscGbrjD6OU37IKzovZooAcmtDyopRB7dGMeajoFtCT2TtBX38mwp3LNqR84iKRPwLlpV+Lv5qpyzQpaqyzcD5TeKObCd85RdSR3AqkDVi7BgkewRpU3M/J1EXZ6a5VbPky4cskRNbQDK/LPFr8AQflO21bwLkciDgRrPvx5Bbp+w/KXukQIOeMVGnygY/j9M/kesXIPDqXQKGnLxKo0H5hZs4u+74F+JshlS4x3FPBX/NemPpAKTD3fZ3MvQqpMLsYdLF4VUO4FizJkPLOaJB/ZJ+JCPJexbI/duj3BpvhPpp/8MP3n0jCH6w9hLqhRBvLkwDYwY/xp6KVLhvWfdqhMFHwJC1nyLmtBc4OHSNhgdqddYaVOUj1q9xzvWyp/LhsqKNguKSn1EnAar4N/+uJ3kwdOHapQLV1Wxk7KBGfD3vawTzlUlpBRP/yrqgVl7mdCEMuj1xpx4EDy/5HXYlGyvmk1/avKia4KpwCowJzIQzHUSigfOOfnaP0+J74b1OhENeeQ9Gg2VwZ7tw5j2MN5FKnE42d9CilrheRYZNm2D25mFoHosHpgEu1/YyK2//ll6bsTfr2pk6YR+3WfwjCR4kgNGEV0=
    on_success: change
    on_failure: always
after_script:
- git clean -df
- gulp bench

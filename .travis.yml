language: node_js
matrix:
  include:
  - os: linux
    dist: trusty
    sudo: required
    node_js: 10
  - os: osx
    node_js: 10
addons:
  chrome: stable
  firefox: latest
before_install:
- if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then export CHROME_BIN=google-chrome-stable; fi
- if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then export DISPLAY=:99.0; fi
- if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sh -e /etc/init.d/xvfb start; fi
script:
- travis_retry npm run ci
before_deploy:
- sed -i 's/"private":\ true/"private":\ false/' package.json
- sed -i -E 's/^dist\/?.*$//' .gitignore
- cp -r src/* .
deploy:
  provider: npm
  email:
    secure: c/u3dsMFxB/JwNNUa3G+aotltA08al8k4SfpJGe3g3/yiNeDz1YSJw9N+2DK8USWrfDK8YB1cZIFscGbrjD6OU37IKzovZooAcmtDyopRB7dGMeajoFtCT2TtBX38mwp3LNqR84iKRPwLlpV+Lv5qpyzQpaqyzcD5TeKObCd85RdSR3AqkDVi7BgkewRpU3M/J1EXZ6a5VbPky4cskRNbQDK/LPFr8AQflO21bwLkciDgRrPvx5Bbp+w/KXukQIOeMVGnygY/j9M/kesXIPDqXQKGnLxKo0H5hZs4u+74F+JshlS4x3FPBX/NemPpAKTD3fZ3MvQqpMLsYdLF4VUO4FizJkPLOaJB/ZJ+JCPJexbI/duj3BpvhPpp/8MP3n0jCH6w9hLqhRBvLkwDYwY/xp6KVLhvWfdqhMFHwJC1nyLmtBc4OHSNhgdqddYaVOUj1q9xzvWyp/LhsqKNguKSn1EnAar4N/+uJ3kwdOHapQLV1Wxk7KBGfD3vawTzlUlpBRP/yrqgVl7mdCEMuj1xpx4EDy/5HXYlGyvmk1/avKia4KpwCowJzIQzHUSigfOOfnaP0+J74b1OhENeeQ9Gg2VwZ7tw5j2MN5FKnE42d9CilrheRYZNm2D25mFoHosHpgEu1/YyK2//ll6bsTfr2pk6YR+3WfwjCR4kgNGEV0=
  api_key:
    secure: "TlYf6fw5mP3OdRTc16cvwwdxcd6YeDNmLpdM19+tPTmuy8zVM/Sr/ktvo1k0a6nBZz9oosNwdPi9t4ZO3B4ovG5rqdtV6Lg+eI72vGTWvotrHJsLwAnQo/P3mVNlCCctQMqZh7/zMjFrjlSkppwVcmD0hD3xQsgswr43G0dWzkPo+mUKJQExm0xd0+lRSxVN0J3XTdRainAYu2WQ5gHLrlq4/AiM2IVcsQF3EmdorTbP/OQvoSe7CKMPXhkhZ9356FYiCYc1ZqtUW+4ArzhSpIQJ/cNDZ5JPohVLJfJPxVeQToSxvhSOqwNX6ITXzBb0HRk+Biy4EcLtBTWIPFadTjTP/Ux0y7zgv9gZaX/tjhadOzl24IzyIHKqgSY0N9YuJCrx0TGbZ+NHgnZYvoGFya2p+W38w+qWwWeovW4VHbjfhqes8FQvH2TJsJdQ26wYIwqTOv7xjHLAxKx2l33XmNqp3PiOJovYbqLenV0IMWtvLMTSxbMnoFmSFyqca0TvbO6rTpwPqzDlsZjNWww6gD78ZeJCwNFL2++af/kmLGwRvYFQtuRSF0mdM9ZPNVq4kw5lFbwI1cbYeBf8e+3WHPZh6LBshGTo55SRBF7uJ0DQIPL+jwCwbsbjwLccWfACE5zo6z77F2RePzoaxnqX2p47OD+WyDFfV0GqxmoU16w="
  on:
    branch: master
    node: 10
    condition: $TRAVIS_OS_NAME = linux
  skip_cleanup: true
notifications:
  email:
    recipients:
      secure: c/u3dsMFxB/JwNNUa3G+aotltA08al8k4SfpJGe3g3/yiNeDz1YSJw9N+2DK8USWrfDK8YB1cZIFscGbrjD6OU37IKzovZooAcmtDyopRB7dGMeajoFtCT2TtBX38mwp3LNqR84iKRPwLlpV+Lv5qpyzQpaqyzcD5TeKObCd85RdSR3AqkDVi7BgkewRpU3M/J1EXZ6a5VbPky4cskRNbQDK/LPFr8AQflO21bwLkciDgRrPvx5Bbp+w/KXukQIOeMVGnygY/j9M/kesXIPDqXQKGnLxKo0H5hZs4u+74F+JshlS4x3FPBX/NemPpAKTD3fZ3MvQqpMLsYdLF4VUO4FizJkPLOaJB/ZJ+JCPJexbI/duj3BpvhPpp/8MP3n0jCH6w9hLqhRBvLkwDYwY/xp6KVLhvWfdqhMFHwJC1nyLmtBc4OHSNhgdqddYaVOUj1q9xzvWyp/LhsqKNguKSn1EnAar4N/+uJ3kwdOHapQLV1Wxk7KBGfD3vawTzlUlpBRP/yrqgVl7mdCEMuj1xpx4EDy/5HXYlGyvmk1/avKia4KpwCowJzIQzHUSigfOOfnaP0+J74b1OhENeeQ9Gg2VwZ7tw5j2MN5FKnE42d9CilrheRYZNm2D25mFoHosHpgEu1/YyK2//ll6bsTfr2pk6YR+3WfwjCR4kgNGEV0=
    on_success: change
    on_failure: always
after_deploy:
- git clean -df
- gulp bench

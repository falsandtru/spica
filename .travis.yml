os: linux
dist: xenial
language: node_js
jobs:
  include:
  - os: linux
    node_js: 12
  - os: osx
    node_js: 12
addons:
  chrome: stable
  firefox: latest
services:
- xvfb
script:
- npm run ci
before_deploy:
- sed -i 's/"private":\ true/"private":\ false/' package.json
- sed -i -E 's/^dist\/?.*$//' .gitignore
- cp -r src/* .
deploy:
  provider: npm
  edge: true
  email:
    secure: c/u3dsMFxB/JwNNUa3G+aotltA08al8k4SfpJGe3g3/yiNeDz1YSJw9N+2DK8USWrfDK8YB1cZIFscGbrjD6OU37IKzovZooAcmtDyopRB7dGMeajoFtCT2TtBX38mwp3LNqR84iKRPwLlpV+Lv5qpyzQpaqyzcD5TeKObCd85RdSR3AqkDVi7BgkewRpU3M/J1EXZ6a5VbPky4cskRNbQDK/LPFr8AQflO21bwLkciDgRrPvx5Bbp+w/KXukQIOeMVGnygY/j9M/kesXIPDqXQKGnLxKo0H5hZs4u+74F+JshlS4x3FPBX/NemPpAKTD3fZ3MvQqpMLsYdLF4VUO4FizJkPLOaJB/ZJ+JCPJexbI/duj3BpvhPpp/8MP3n0jCH6w9hLqhRBvLkwDYwY/xp6KVLhvWfdqhMFHwJC1nyLmtBc4OHSNhgdqddYaVOUj1q9xzvWyp/LhsqKNguKSn1EnAar4N/+uJ3kwdOHapQLV1Wxk7KBGfD3vawTzlUlpBRP/yrqgVl7mdCEMuj1xpx4EDy/5HXYlGyvmk1/avKia4KpwCowJzIQzHUSigfOOfnaP0+J74b1OhENeeQ9Gg2VwZ7tw5j2MN5FKnE42d9CilrheRYZNm2D25mFoHosHpgEu1/YyK2//ll6bsTfr2pk6YR+3WfwjCR4kgNGEV0=
  api_token:
    secure: "qbcb3zpPtf3hUAJTUqmdgKzoOhknCbs2ooZQiIJYJwBkknBSul/KO97QiVqQBldq8oCudc4oSSvnZjmvEm5iWr9xKNtRvntu/AYWeJdxbvv/Af/9ZXeZwwtykhQWA3WEkO9SXhp/BWT+orAd3DsiO2c2kXQqYjdudCqkNJrmE+JJp+b4dOMjT0MZ+uKWewspEkia5W4bDCdNCxG0FV8GJC+H+S0JmAbkAe1zyWbukaVSBpimXtDf9TIZ3uvSUBwUCZV+x5IXt/DI4BHTjx+a6psICIlZSDDW2sCUw2YhOjpMSeyfhYNP64Ci+RI9QKa7CiCNrydK+5ZpiJr5j1qxKFHZhZ4oC1zJR5M36/xpwghqdZPv0t1IHF2wQtUuVAMXsDENqbN1RCU7AUzsyvDEKsCdwXtaAuW7/YesD7uYyHRiR8On0kpDtRQprCvyYFJYMg6bPpYWkcZ5qjfoe+J+BVDzX5xNB7YMouweTt1C1TPcpyASWlUDuelIMXJOXrGnvcxfFnXxre85sQvgi89Ox0ZsFEhYetUVMgPpVy8HZurT8SV7yADNnyM8GDcW3jskMhp9go8RaJlaL4dLu16ZyPML9cVuzXRgenwo/iNzLfUGqvE8OB4+Lpwi6AYOvpNJjwPO2o/L9gwSfyJeAphX1rXP6jpB+FS4AWDyKO982Ww="
  on:
    node_js: 12
    condition:
    - $TRAVIS_BRANCH = master
    - $TRAVIS_EVENT_TYPE = push
    - $TRAVIS_COMMIT_MESSAGE =~ ^v[0-9]+(\.[0-9]+)*($|\n)
    - $TRAVIS_OS_NAME = linux
notifications:
  email:
    recipients:
      secure: c/u3dsMFxB/JwNNUa3G+aotltA08al8k4SfpJGe3g3/yiNeDz1YSJw9N+2DK8USWrfDK8YB1cZIFscGbrjD6OU37IKzovZooAcmtDyopRB7dGMeajoFtCT2TtBX38mwp3LNqR84iKRPwLlpV+Lv5qpyzQpaqyzcD5TeKObCd85RdSR3AqkDVi7BgkewRpU3M/J1EXZ6a5VbPky4cskRNbQDK/LPFr8AQflO21bwLkciDgRrPvx5Bbp+w/KXukQIOeMVGnygY/j9M/kesXIPDqXQKGnLxKo0H5hZs4u+74F+JshlS4x3FPBX/NemPpAKTD3fZ3MvQqpMLsYdLF4VUO4FizJkPLOaJB/ZJ+JCPJexbI/duj3BpvhPpp/8MP3n0jCH6w9hLqhRBvLkwDYwY/xp6KVLhvWfdqhMFHwJC1nyLmtBc4OHSNhgdqddYaVOUj1q9xzvWyp/LhsqKNguKSn1EnAar4N/+uJ3kwdOHapQLV1Wxk7KBGfD3vawTzlUlpBRP/yrqgVl7mdCEMuj1xpx4EDy/5HXYlGyvmk1/avKia4KpwCowJzIQzHUSigfOOfnaP0+J74b1OhENeeQ9Gg2VwZ7tw5j2MN5FKnE42d9CilrheRYZNm2D25mFoHosHpgEu1/YyK2//ll6bsTfr2pk6YR+3WfwjCR4kgNGEV0=
    on_success: change
    on_failure: always
after_script:
- git clean -df
- gulp bench
